{% style %}
  footer {
    background: url("{{ 'footer-bg.png' | asset_url }}") #132142;
    background-repeat: no-repeat;
    background-size: cover;
  }
{% endstyle %}

  <div class="container">
    <div class="top">
      <div class="form">
        <p>Join our table to receive updates, campaign stories and more</p>
        <div class="newsletter">
          {% comment %} {% form 'customer', id: 'NewsletterForm', class: 'newsletter' %}

            {%- if form.posted_successfully? -%} 
              <div role="status">
                Thankyou
              </div>
            {%- elsif form.errors -%}
              <div role="alert">
                {% for field in form.errors %}
                  {%- if field == 'email' -%}
                    Invalid Email Address
                  {%- else -%}
                    {{ form.errors.messages[field] }}
                  {%- endif -%}
                {% endfor %}
              </div>
            {% else %}
              <input type="hidden" name="contact[tags]" value="newsletter">

              <input
                id="NewsletterEmail"
                type="email"
                name="contact[email]"
                placeholder="Enter Your Email"
                required
                aria-required="true"
                autocomplete="email"
              />

              <button class="newsletter__button" type="submit">
                SEND
              </button>
            {% endif %}
          {% endform %} {% endcomment %}
          <div id="NewsletterForm">
            <input 
              type="email" 
              id="newsletter-email" 
              placeholder="Enter your email" 
              required
            >
            <button id="newsletter-submit">SEND</button>

            <div id="newsletter-message"></div>
          </div>
        </div>
      </div>
      <div class="menu-group">
        {% comment %} <div class="menu">
          <div class="menu-label">[Products]</div>
          {% for link in section.settings.product_menu.links %}
            <a href="{{ link.url }}">{{ link.title }}</a>
          {% endfor %}
        </div> {% endcomment %}
        {% comment %} <div class="menu">
          <div class="menu-label">[Company]</div>
          {% for link in section.settings.company_menu.links %}
            <a href="{{ link.url }}">{{ link.title }}</a>
          {% endfor %}
        </div> {% endcomment %}
        <div class="menu">
          <div class="menu-label">[Social]</div>
          {% for link in section.settings.social_menu.links %}
            <a href="{{ link.url }}">{{ link.title }}</a>
          {% endfor %}
        </div>
      </div>
    </div>
    <div class="brand">Feenie's table</div>
    <div class="copy">
      <div> {{ section.settings.copyright }} </div>
      <div>
        <a href=""> Terms & Conditions </a>
        <a href=""> Privacy Policy </a>
      </div>
    </div>
  </div>

<script>
  $(document).ready(function () {
    $("#newsletter-form").on("submit", function (e) {
      e.preventDefault();

      var form = $(this);
      var formData = form.serialize();

      $.ajax({
        type: "POST",
        url: form.attr("action"),
        data: formData,
        dataType: "html",
        success: function (response) {
          // Shopify return HTML, jadi kita cek apakah ada pesan sukses
          if (response.indexOf("newsletter__confirmation") > -1 || response.indexOf("Thank you") > -1) {
            $("#newsletter-message").html("<p style='color:green;'>Thank you for subscribing!</p>");
            form[0].reset();
          } else {
            $("#newsletter-message").html("<p style='color:red;'>Something went wrong. Please try again.</p>");
          }
        },
        error: function () {
          $("#newsletter-message").html("<p style='color:red;'>Server error. Please try again later.</p>");
        }
      });
    });
  });
</script>


{% schema %}
{
  "name": "Footer",
  "tag": "footer",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Copyright text"
    },
    {
      "type": "text",
      "id": "copyright",
      "label": "Footer copyright text",
      "default": "Â© <span>2025</span> Feenie's Table. | All Rights Reserved",
      "info": "Use <span/> to show year automaticly"
    },
    {
      "type": "header",
      "content": "Footer menu"
    },
    {
      "type": "link_list",
      "id": "product_menu",
      "label": "Product menu"
    },
    {
      "type": "link_list",
      "id": "company_menu",
      "label": "Company menu"
    },
    {
      "type": "link_list",
      "id": "social_menu",
      "label": "Social menu"
    },
  ],
}
{% endschema %}

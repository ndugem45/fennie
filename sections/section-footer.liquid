{% style %}
  footer {
    background: url("{{ 'footer-bg.png' | asset_url }}") #132142;
    background-repeat: no-repeat;
    background-size: cover;
  }
{% endstyle %}

  <div class="container">
    <div class="top">
      <div class="form">
        <p>Join our table to receive updates, campaign stories and more</p>
        <div class="newsletter">
          {% comment %} {% form 'customer', id: 'NewsletterForm', class: 'newsletter' %}

            {%- if form.posted_successfully? -%} 
              <div role="status">
                Thankyou
              </div>
            {%- elsif form.errors -%}
              <div role="alert">
                {% for field in form.errors %}
                  {%- if field == 'email' -%}
                    Invalid Email Address
                  {%- else -%}
                    {{ form.errors.messages[field] }}
                  {%- endif -%}
                {% endfor %}
              </div>
            {% else %}
              <input type="hidden" name="contact[tags]" value="newsletter">

              <input
                id="NewsletterEmail"
                type="email"
                name="contact[email]"
                placeholder="Enter Your Email"
                required
                aria-required="true"
                autocomplete="email"
              />

              <button class="newsletter__button" type="submit">
                SEND
              </button>
            {% endif %}
          {% endform %} {% endcomment %}

          {% comment %} <div id="newsletter-wrapper"> {% endcomment %}
            <input 
              type="email" 
              id="newsletter-email" 
              placeholder="Enter your email" 
              aria-label="Email address"
            />
            <div id="newsletter-message"></div>
            <button id="newsletter-submit">SEND</button>
          </div>
          {% comment %}  {% endcomment %}
      </div>
      <div class="menu-group">
        {% comment %} <div class="menu">
          <div class="menu-label">[Products]</div>
          {% for link in section.settings.product_menu.links %}
            <a href="{{ link.url }}">{{ link.title }}</a>
          {% endfor %}
        </div> {% endcomment %}
        {% comment %} <div class="menu">
          <div class="menu-label">[Company]</div>
          {% for link in section.settings.company_menu.links %}
            <a href="{{ link.url }}">{{ link.title }}</a>
          {% endfor %}
        </div> {% endcomment %}
        <div class="menu">
          <div class="menu-label">[Social]</div>
          {% for link in section.settings.social_menu.links %}
            <a href="{{ link.url }}">{{ link.title }}</a>
          {% endfor %}
        </div>
      </div>
    </div>
    <div class="brand">Feenie's table</div>
    <div class="copy">
      <div> {{ section.settings.copyright }} </div>
      <div>
        <a href=""> Terms & Conditions </a>
        <a href=""> Privacy Policy </a>
      </div>
    </div>
  </div>

<script>
  $(document).ready(function () {
    $('#newsletter-submit').on('click', function (e) {
      e.preventDefault();

      var email = $('#newsletter-email').val();
      var $message = $('#newsletter-message');

      if (!email) {
        $message.text("Please enter your email").css("color", "red");
        return;
      }

      $.ajax({
        type: 'POST',
        url: '/account/subscribe', 
        data: {
          email: email
        },
        headers: {
          'Accept': 'application/json'  // force JSON response
        },
        success: function (res) {
          if (res && res.ok) {
            $message.text("Thanks for subscribing!").css("color", "green");
            $('#newsletter-email').val('');
          } else {
            $message.text("This email may already be subscribed.").css("color", "red");
          }
        },
        error: function (xhr) {
          let err = xhr.responseJSON?.errors || "Something went wrong.";
          $message.text(err).css("color", "red");
          console.log("Error:", xhr.responseJSON);
        }
      });
    });
  });
</script>






{% schema %}
{
  "name": "Footer",
  "tag": "footer",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Copyright text"
    },
    {
      "type": "text",
      "id": "copyright",
      "label": "Footer copyright text",
      "default": "Â© <span>2025</span> Feenie's Table. | All Rights Reserved",
      "info": "Use <span/> to show year automaticly"
    },
    {
      "type": "header",
      "content": "Footer menu"
    },
    {
      "type": "link_list",
      "id": "product_menu",
      "label": "Product menu"
    },
    {
      "type": "link_list",
      "id": "company_menu",
      "label": "Company menu"
    },
    {
      "type": "link_list",
      "id": "social_menu",
      "label": "Social menu"
    },
  ],
}
{% endschema %}
